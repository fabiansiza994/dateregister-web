<div class="verify-outer">
  <div class="verify-card">
    <div class="verify-header">
      <div class="verify-icon">üîí</div>
      <div>
        <h3 class="verify-title">Activar cuenta</h3>
        <small class="verify-sub">Valida el c√≥digo enviado a tu correo</small>
      </div>
    </div>
    <a routerLink="/login" class="verify-back">&larr; Volver al login</a>

  @if (error()) {
    <div class="rounded-lg border border-red-300 bg-red-50 text-red-700 px-4 py-3 text-sm flex items-start gap-3 mb-4" role="alert">
      <span class="mt-0.5 text-red-600">‚ö†Ô∏è</span>
      <div class="flex-1">{{ error() }}</div>
      <button type="button" class="inline-flex items-center justify-center w-6 h-6 rounded-full text-red-600 hover:bg-red-200/50 transition" (click)="error.set(null)" aria-label="Cerrar">‚úï</button>
    </div>
  }

  @if (info()) {
    <div class="rounded-lg border border-green-300 bg-green-50 text-green-700 px-4 py-3 text-sm flex items-start gap-3 mb-4" role="alert">
      <span class="mt-0.5 text-green-600">‚úÖ</span>
      <div class="flex-1">{{ info() }}</div>
      <button type="button" class="inline-flex items-center justify-center w-6 h-6 rounded-full text-green-600 hover:bg-green-200/50 transition" (click)="info.set(null)" aria-label="Cerrar">‚úï</button>
    </div>
  }

    <form (submit)="$event.preventDefault(); verify()" class="verify-form">
      <div class="verify-body">
        <div class="mb-3 text-xs text-slate-500">
          <span class="font-medium">Usuario ID:</span>
          <span class="font-mono text-slate-700">{{ userId || '‚Äî' }}</span>
        </div>

        <div class="grid grid-cols-12 gap-5 items-center">
          <div class="col-span-12 md:col-span-8">
            <label class="block text-sm font-medium mb-2">C√≥digo de verificaci√≥n</label>
            <input
              class="code-input"
              placeholder="Ingresa el c√≥digo (ej. 123456)"
              [(ngModel)]="code"
              name="code"
              autocomplete="one-time-code"
              [disabled]="loading()"
            >
            <div class="mt-2 text-xs text-slate-500">Revisa tu correo y copia el c√≥digo. El c√≥digo tiene formato num√©rico.</div>
          </div>

          <div class="col-span-12 md:col-span-4 actions-col">
            <button type="submit"
              class="btn-primary"
              [disabled]="!canSubmit()">
              @if (loading()) { <span class="animate-spin inline-block w-4 h-4 border-2 border-current border-t-transparent rounded-full mr-2"></span> }
              Validar
            </button>

            <button type="button" class="btn-secondary" (click)="resendCode()" [disabled]="resendCooldown() > 0 || resendLoading()">
              @if (resendLoading()) { <span class="animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"></span> }
              Reenviar c√≥digo
            </button>

            @if (resendCooldown() > 0) {
              <div class="mt-2 text-center text-xs text-slate-500">Puedes reenviar en {{ formatCountdown(resendCooldown()) }}</div>
            }
          </div>
        </div>
      </div>
    </form>
  </div>
</div>
