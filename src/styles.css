@import "leaflet/dist/leaflet.css";
@import "flatpickr/dist/flatpickr.css";
@import "flatpickr/dist/themes/material_blue.css";
@import "./tailwind-bridge.css";
@tailwind base;
@tailwind components;
@tailwind utilities;

/* ====================================================================== */
/* ===============   VARIABLES GLOBALES – TEMA CLARO FIJO   ============= */
/* ====================================================================== */
:root{
  /* Paleta */
  --dr-bg:#f6f7fb;
  --dr-surface:#ffffff;
  --dr-card:#ffffff;
  --dr-text:#0f172a;
  --dr-muted:#64748b;               /* slate-500-ish */
  --dr-brand:#7c3aed;               /* violet-600 */
  --dr-brand-2:#22d3ee;             /* cyan-400 */
  --dr-success:#22c55e;
  --dr-warning:#f59e0b;
  --dr-danger:#ef4444;

  /* Color principal de la aplicación (MENÚ y topbars móviles)
     Cambia estas dos variables para actualizar el azul en TODO el sitio. */
  --bs-primary: #1a3644;            /* color */
  --bs-primary-rgb:26,54,68;       /* r,g,b (sin espacios) – coincide con #1a3644 */

  /* Decoración */
  --dr-radius:18px;
  --dr-radius-sm:12px;
  --dr-shadow-1:0 10px 30px rgba(16,24,40,.25);
  --dr-shadow-2:0 24px 60px rgba(16,24,40,.35);
  --dr-border:1px solid rgba(15,23,42,.08);

  /* Campos (light) */
  --dr-field-bg:#ffffff;
  --dr-field-bg-hover:#f8fafc;
  --dr-field-border:rgba(15,23,42,.12);
  --dr-field-text:#0b1220;
  --dr-field-placeholder: rgba(15,23,42,.45); /* placeholder CLARO, no negro */

  /* Tipografía global */
  --dr-font-sans: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
  --dr-body-size: 16px;       /* base = 16px (evita zoom iOS en inputs) */
  --dr-body-lh: 1.5;
  --dr-text-weight: 400;
  --dr-heading-weight: 700;

  /* Si usas Bootstrap 5.3, sincroniza */
  --bs-body-font-family: var(--dr-font-sans);
  --bs-body-font-size: 1rem;         /* 16px */
  --bs-body-line-height: var(--dr-body-lh);
  --bs-body-font-weight: var(--dr-text-weight);
}

/* ====================================================================== */
/* ======================   BASE / TYPO GLOBAL   ======================== */
/* ====================================================================== */
html, body { height: 100%; overflow-x: hidden; }
html { font-size: 100%; }
body{
  display:flex; flex-direction:column; min-height:100vh;
  background: radial-gradient(1200px 800px at 10% -10%, #eef2ff 10%, #f6f7fb 60%), var(--dr-bg);
  color: var(--dr-text);

  font-family: var(--dr-font-sans);
  font-size: var(--bs-body-font-size, 1rem);
  line-height: var(--dr-body-lh);
  font-weight: var(--dr-text-weight);
  -webkit-text-size-adjust: 100%;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;
}

/* Encabezados fluidos */
h1, h2, h3, h4, h5, h6 { font-weight: var(--dr-heading-weight); line-height: 1.2; margin: .5em 0 .25em; }
h1 { font-size: clamp(1.875rem, 1.25rem + 2vw, 2.375rem); }  /* ~30–38px */
h2 { font-size: clamp(1.5rem,   1.1rem  + 1.5vw, 2rem);    }  /* ~24–32px */
h3 { font-size: clamp(1.25rem,  1.0rem  + 1vw,   1.5rem);  }  /* ~20–24px */
h4 { font-size: 1.125rem; }
h5 { font-size: 1rem; }
h6 { font-size: .95rem; }
p { margin: 0 0 .75rem; }
small, .small, .form-text { font-size: .875rem !important; line-height: 1.4; } /* 14px */

/* Navbar / dropdown / tablas / botones */
.navbar .nav-link { font-size: .95rem; font-weight: 500; }
.dropdown-item { font-size: .95rem; line-height: 1.35; }
table, .table { font-size: .95rem; line-height: 1.45; }
.btn { font-size: .95rem; font-weight: 600; line-height: 1.35; }

/* ====================================================================== */
/* =====================   LAYOUT STICKY FOOTER   ======================= */
/* ====================================================================== */
app-root, .app-shell { display:flex; flex-direction:column; min-height:100vh; }
.main-content { flex: 1 0 auto; }
app-footer { margin-top:auto; display:block; }

/* ====================================================================== */
/* ===========================   CARDS   ================================= */
/* ====================================================================== */
.dr-card{
  background: linear-gradient(180deg, rgba(0,0,0,.02), rgba(0,0,0,0));
  border: var(--dr-border);
  border-radius: var(--dr-radius);
  box-shadow: var(--dr-shadow-1);
  /* Evitar blur en Android WebView por nitidez de fuentes */
  backdrop-filter: none;
  transition: transform .25s ease, box-shadow .25s ease, border-color .25s ease;
}
.dr-card:hover{ transform: translateY(-4px); box-shadow: var(--dr-shadow-2); border-color: rgba(15,23,42,.14); }
.dr-card-header{
  display:flex; align-items:center; justify-content:space-between;
  padding:12px 16px; border-bottom: var(--dr-border);
  background: linear-gradient(to bottom, rgba(124,58,237,.06), rgba(124,58,237,0));
  border-top-left-radius: var(--dr-radius); border-top-right-radius: var(--dr-radius);
}

/* ====================================================================== */
/* =========================   BOTONES   ================================= */
/* ====================================================================== */
.btn-soft-primary{
  color:#fff; background: linear-gradient(135deg, var(--dr-brand), #5b21b6);
  border:none; border-radius:12px; padding:.6rem 1rem;
  box-shadow: 0 10px 24px rgba(124,58,237,.35);
  transition: transform .15s ease, box-shadow .2s ease, filter .2s ease;
}
.btn-soft-primary:hover{ transform: translateY(-2px); filter: brightness(1.05); }
.btn-soft-primary:active{ transform: translateY(0); box-shadow: 0 6px 16px rgba(124,58,237,.25); }

.btn-ghost{
  border-radius:12px; padding:.55rem .9rem;
  border:1px dashed rgba(15,23,42,.18);
  color:var(--dr-text); background:transparent;
  transition: background .2s ease, border-color .2s ease;
}
.btn-ghost:hover{ border-color: rgba(15,23,42,.35); background: rgba(15,23,42,.04); }

/* ====================================================================== */
/* ==========================   BADGES   ================================= */
/* ====================================================================== */
.dr-badge{
  display:inline-flex; align-items:center; gap:.4rem;
  font-size:.75rem; padding:.25rem .55rem; border-radius:999px;
  border:1px solid rgba(15,23,42,.14);
  color:var(--dr-muted); background: rgba(15,23,42,.04);
}
.dr-badge.success{ color:#16a34a; border-color: rgba(22,163,74,.30); background: rgba(22,163,74,.08); }
.dr-badge.warn{ color:#b45309; border-color: rgba(180,83,9,.30); background: rgba(245,158,11,.12); }
.dr-badge.danger{ color:#dc2626; border-color: rgba(220,38,38,.30); background: rgba(239,68,68,.10); }

/* ====================================================================== */
/* ===================   FORMULARIOS (ALTO CONTRASTE)   ================= */
/* ====================================================================== */
.form-control,
.form-select,
.form-check-input,
.form-control-plaintext,
.input-group-text{
  background: var(--dr-field-bg) !important;
  border: 1px solid var(--dr-field-border) !important;
  color: var(--dr-field-text) !important;
  -webkit-text-fill-color: var(--dr-field-text) !important;
  border-radius: 12px !important;
  caret-color: var(--dr-field-text);
  font-size: 1rem !important;       /* 16px consistente */
  line-height: 1.5 !important;
  font-weight: 400 !important;       /* sin “negrita fantasma” */
  letter-spacing: 0 !important;
  color-scheme: light;               /* widgets nativos claros */
}
.form-control:hover, .form-select:hover{ background: var(--dr-field-bg-hover) !important; }

/* Placeholders claros (no negros, ni bold) */
.form-control::placeholder,
.form-select::placeholder,
input::placeholder,
textarea::placeholder{
  color: var(--dr-field-placeholder) !important;
  font-weight: 400 !important;
  opacity: 1 !important;             /* Safari */
}
/* WebKit legacy */
::-webkit-input-placeholder{
  color: var(--dr-field-placeholder) !important;
  font-weight: 400 !important;
}

/* Focus */
.form-control:focus, .form-select:focus{
  border-color: rgba(124,58,237,.55) !important;
  box-shadow: 0 0 0 .18rem rgba(124,58,237,.15) !important;
}

/* Readonly/Disabled */
.form-control[readonly]{
  background:#f8fafc !important;
  color:#0b1220 !important;
  -webkit-text-fill-color:#0b1220 !important;
}
.form-control:disabled, .form-select:disabled{
  background:#f8fafc !important;
  color:#0b1220 !important;
  opacity:.95 !important;
}

/* Input group */
.input-group-text{
  background:#ffffff !important;
  border:1px solid rgba(15,23,42,.12) !important;
  color:#0b1220 !important;
}

/* Autofill (quita amarillo) */
input:-webkit-autofill,
textarea:-webkit-autofill,
select:-webkit-autofill{
  -webkit-text-fill-color:#0b1220 !important;
  box-shadow:0 0 0 1000px #ffffff inset !important;
  transition: background-color 99999s ease-out, color 99999s ease-out;
}

/* iOS: evita “zoom” al enfocar (mantén 16px) */
@media (max-width: 480px){
  .form-control,
  .form-select,
  .input-group-text { font-size: 1rem !important; }
}

/* Página de login: un pelín más discretos */
.page-login .form-control,
.page-login .form-select,
.page-login .input-group-text {
  font-size: .95rem !important;      /* ~15.2px en desktop */
  font-weight: 400 !important;
}
.page-login .form-control::placeholder,
.page-login .form-select::placeholder {
  color: rgba(15,23,42,.40) !important; /* aún más suaves en login */
}

/* ====================================================================== */
/* ==================   PROGRESO / MODALES / VARIANTES   ================= */
/* ====================================================================== */
.progress{ background: rgba(15,23,42,.10); border-radius:999px; }
.progress-bar{ background: linear-gradient(135deg, var(--dr-brand), var(--dr-brand-2)); }

.modal-content{
  background: var(--dr-card); color: var(--dr-text);
  border: var(--dr-border); border-radius:16px; box-shadow: var(--dr-shadow-2);
}
.modal-header{ border-bottom: var(--dr-border); }
.modal-footer{ border-top: var(--dr-border); }

/* Variante clara opcional (si la usas en contenedores con .modal-light) */
.modal-light .modal-content{
  background:#ffffff !important; color:#0f172a !important;
  border:1px solid rgba(15,23,42,.08) !important;
}
.modal-light .modal-header,
.modal-light .modal-footer{ border-color: rgba(15,23,42,.08) !important; }
.modal-light .dr-item{
  background:#ffffff !important; color:#0f172a !important;
  border:1px solid rgba(15,23,42,.12) !important;
}
.modal-light .dr-item:hover{
  background:#f8fafc !important; border-color: rgba(15,23,42,.18) !important;
}
.modal-light .dr-badge{
  background:#f1f5f9 !important; color:#334155 !important;
  border:1px solid rgba(15,23,42,.08) !important;
}

/* ====================================================================== */
/* ==================   LISTAS / GRID / MICRO-UX   ====================== */
/* ====================================================================== */
.dr-item{
  border:1px solid rgba(15,23,42,.12); background:#ffffff;
  border-radius:14px; padding:.8rem 1rem; transition: background .2s, border-color .2s, transform .2s;
  cursor:pointer;
}
.dr-item:hover{ background:#f8fafc; border-color: rgba(15,23,42,.18); transform: translateY(-1px); }

.dr-grid{ display:grid; gap:16px; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); }
.dr-divider{ height:1px; background: rgba(15,23,42,.12); margin:.75rem 0; }

.img-thumbnail{ transition: transform .25s ease, filter .25s ease; }
.img-thumbnail:hover{ transform: scale(1.02); filter: saturate(1.05) contrast(1.02); }

/* ====================================================================== */
/* =========================   DRIVER.JS   ============================== */
/* ====================================================================== */
.driver-overlay{ z-index:1990 !important; }
.driver-stage,
.driver-popover,
.driver-highlighted-element,
.driver-fix-stacking{ z-index:1995 !important; }

/* Evita transforms/filters que interfieran con el highlight del tour */
.navbar, .navbar *{ transform:none !important; filter:none !important; }

/* ====================================================================== */
/* ===========================   LEAFLET   ============================== */
/* ====================================================================== */
#usage-map{ height:70vh; width:100%; }
.leaflet-container{ height:70vh; width:100%; }

/* ================================================================ */
/* ====== Micro-UX comunes: chispas click y salida de tarjetas ==== */
/* ================================================================ */
.dr-sparks-container { pointer-events: none; }
.dr-spark {
  position: absolute;
  left: 0; top: 0;
  width: 4px; height: 4px;
  border-radius: 9999px; opacity: .95;
  box-shadow: 0 0 6px rgba(0,0,0,.12);
  transform: translate(0, 0) scale(1);
  animation: dr-spark-flight var(--d, 480ms) cubic-bezier(.2,.7,.2,1) forwards;
}
@keyframes dr-spark-flight {
  0% { opacity: 1; transform: translate(0, 0) scale(1); }
  60% { opacity: 0.9; }
  100% { opacity: 0; transform: translate(var(--tx, 0px), var(--ty, 0px)) scale(0.6); }
}
.dr-fly-away { animation: dr-fly-away .32s ease both; }
@keyframes dr-fly-away { to { opacity: 0; transform: translateX(-10px) scale(.98); } }

/* ================================================================ */
/* ===================  Paginación sticky (móvil)  ================= */
/* ================================================================ */
.dr-sticky-pager{
  position: sticky;
  bottom: calc(5rem + .5rem);
  z-index: 25;
  background: #ffffff;
  border-radius: .75rem;
  border: 1px solid rgba(100,116,139,.35);
  box-shadow: 0 8px 30px rgba(2,6,23,.08);
  padding: .25rem .5rem;
}

/* ================================================================ */
/* ===================  Swipeable list items  ===================== */
/* ================================================================ */
/* Make list items swipeable across modules (Clientes/Pacientes/Usuarios/Trabajos) */
.dr-swipeable { position: relative; overflow: hidden; touch-action: pan-y; }
/* Move spacing to the sliding content to avoid red edges showing */
.dr-wa-item { gap: 0; padding: 0; background: transparent; }
.dr-swipe-content{
  position: relative; z-index: 2; background: #ffffff; will-change: transform; transition: transform .18s ease;
  display: flex; gap: .75rem; align-items: stretch; width: 100%; flex: 1 1 auto;
  padding: .75rem .875rem;
}
.dr-swipe-bg{ position:absolute; inset:0; z-index:1; display:flex; align-items:center; gap:.5rem; font-weight:700; letter-spacing:.01em; pointer-events:none; }
/* Right side (reveal when swiping left): Delete → fondo rojo y texto blanco */
.dr-swipe-bg-left{
  justify-content:flex-end; padding-right:.875rem;
  background: linear-gradient(90deg, #ef4444 0%, #dc2626 100%); /* red-500 → red-600 */
  color:#ffffff;
  /* Sólo mitad derecha para que no tape el azul */
  left: auto; right: 0; width: 50%;
}
.dr-swipe-bg-left i{ font-size:18px; color:#ffffff; }
.dr-swipe-bg-left span{ font-size:12px; color:#ffffff; }
/* Left side (reveal when swiping right): Edit → fondo azul/primario y texto blanco */
.dr-swipe-bg-right{
  justify-content:flex-start; padding-left:.875rem;
  /* Azul fijo (no depende de --bs-primary-rgb para evitar tonos verdes) */
  background: linear-gradient(90deg, #2563eb 0%, #1d4ed8 100%);
  color:#ffffff;
  /* Sólo mitad izquierda */
  left: 0; right: auto; width: 50%;
}
.dr-swipe-bg-right i{ font-size:18px; color:#ffffff; }
.dr-swipe-bg-right span{ font-size:12px; color:#ffffff; }
@media (min-width: 768px){
  .dr-sticky-pager { position: static !important; bottom: auto; background: transparent; box-shadow: none; border: 0; padding: 0; }
}

/* When crossing the threshold (set by directive), lock visual to one side and show a check */
.dr-swipe-check{
  position:absolute; inset:0; z-index:1; display:flex; align-items:center;
  color:#fff; opacity:0; transform: scale(.9);
  transition: opacity .12s ease, transform .12s ease;
  pointer-events:none; font-size:22px;
}
.dr-confirm-delete .dr-swipe-check,
.dr-confirm-edit .dr-swipe-check{ opacity:1; transform: scale(1); }
.dr-confirm-delete .dr-swipe-bg-right{ opacity:0; }
.dr-confirm-edit .dr-swipe-bg-left{ opacity:0; }
.dr-confirm-delete .dr-swipe-bg-left{ left:0; right:0; width:100%; }
.dr-confirm-edit .dr-swipe-bg-right{ left:0; right:0; width:100%; }
/* Align the check near the action label */
.dr-confirm-delete .dr-swipe-check{ justify-content:flex-end; padding-right:.875rem; }
.dr-confirm-edit .dr-swipe-check{ justify-content:flex-start; padding-left:.875rem; }
/* When confirmed, hide the label/icon on the active bg to emphasize the check */
.dr-confirm-delete .dr-swipe-bg-left i,
.dr-confirm-delete .dr-swipe-bg-left span,
.dr-confirm-edit .dr-swipe-bg-right i,
.dr-confirm-edit .dr-swipe-bg-right span{ opacity:.0; transition: opacity .12s ease; }

/* While dragging, hide opposite side immediately to avoid any color peeking */
.dr-drag-left .dr-swipe-bg-right{ opacity:0; }
.dr-drag-right .dr-swipe-bg-left{ opacity:0; }

/* ===== Fix visual para switches Bootstrap ===== */
.form-switch .form-check-input{
  width: 2.5rem;
  height: 1.35rem;
  border-radius: 999px !important;
  background-color: #e2e8f0 !important;           /* gris suave base */
  background-image: none !important;               /* evita íconos heredados */
  border-color: var(--dr-field-border) !important;
  transition: background-color .2s, border-color .2s, box-shadow .2s;
}

.form-switch .form-check-input:focus{
  box-shadow: 0 0 0 .18rem rgba(124,58,237,.15) !important;
  border-color: rgba(124,58,237,.55) !important;
}

.form-switch .form-check-input:checked{
  background-color: var(--dr-brand) !important;    /* ON = violeta marca */
  border-color: var(--dr-brand) !important;
}

/* “perilla” del switch (emula la de Bootstrap) */
.form-switch .form-check-input{
  position: relative;
}
.form-switch .form-check-input::after{
  content: "";
  position: absolute;
  top: 2px; left: 2px;
  width: 1rem; height: 1rem;
  background: #fff; border-radius: 50%;
  box-shadow: 0 1px 2px rgba(0,0,0,.2);
  transition: transform .2s ease;
}
.form-switch .form-check-input:checked::after{
  transform: translateX(1.15rem);
}

/* Deshabilitado */
.form-switch .form-check-input:disabled{
  opacity:.55;
  cursor:not-allowed;
}

/* ============================================= */
/* === Ajuste visual para Trabajos en móvil === */
/* Quita la sombra del navbar para que el topbar móvil se lea como parte del menú */
@media (max-width: 767.98px){
  body.page-trabajos nav.sticky-top{ box-shadow: none !important; }
  /* Elimina el padding superior del main (py-4) para evitar separación con el topbar móvil */
  body.page-trabajos main{ padding-top: 0 !important; }
  /* Clientes: mismo ajuste para unir menú y topbar de búsqueda */
  body.page-clientes nav.sticky-top{ box-shadow: none !important; }
  body.page-clientes main{ padding-top: 0 !important; }
  /* Pacientes: mismo ajuste */
  body.page-pacientes nav.sticky-top{ box-shadow: none !important; }
  body.page-pacientes main{ padding-top: 0 !important; }
  /* Usuarios: mismo ajuste */
  body.page-usuarios nav.sticky-top{ box-shadow: none !important; }
  body.page-usuarios main{ padding-top: 0 !important; }
  /* Reportes: mismo ajuste */
  body.page-reportes nav.sticky-top{ box-shadow: none !important; }
  body.page-reportes main{ padding-top: 0 !important; }
}

/* ================================================================ */
/* ============  Toast de Undo – estilos globales sutiles  ========= */
/* ================================================================ */
.dr-undo-time{ font-size: 12px; color: #64748b; }
.dr-undo-progress{
  position: absolute; left: 6px; right: 6px; bottom: 4px; height: 2px;
  background: rgba(2,6,23,.06);
  border-radius: 9999px; overflow: hidden;
}
.dr-undo-progress-bar{
  height: 100%; width: 0%;
  background: var(--bs-primary, #0d6efd);
  opacity: .85;
  transition: width .1s linear;
}

/* ===== Toast de Undo: contenedor y caja (global) ===== */
.dr-undo-toast{
  position: fixed; left: 50%; transform: translateX(-50%);
  bottom: calc(72px + env(safe-area-inset-bottom));
  z-index: 80;
  pointer-events: none; /* deja pasar clicks fuera del toast */
}
.dr-undo-box{
  pointer-events: auto;
  display: inline-flex; align-items: center; gap: .75rem;
  background: #ffffff; color: var(--dr-text, #0f172a);
  border: 1px solid rgba(15,23,42,.12);
  border-radius: .75rem; box-shadow: 0 10px 24px rgba(2,6,23,.14);
  padding: .625rem .75rem .625rem .625rem;
  position: relative; /* para el progress bar absoluto */
}
.dr-undo-text{ display: inline-flex; align-items: center; gap: .5rem; font-size: 13px; color: #0f172a; }
.dr-undo-text i{ opacity: .8; color: #64748b; }
.dr-undo-btn{ color: var(--bs-primary, #0d6efd) !important; font-weight: 700; text-decoration: none; padding: .25rem .5rem; }

@media (min-width: 768px){
  .dr-undo-toast{ bottom: 18px; }
}
